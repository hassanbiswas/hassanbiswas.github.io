name: Monthly SEO Auto-Update

on:
  schedule:
    - cron: '0 0 1 * *' # Runs at midnight on the 1st of every month
  push:
    paths:
      - '**.html' # Runs whenever you update your frontend code
  workflow_dispatch: # Allows you to trigger it manually if needed

jobs:
  build:
    runs-on: ubuntu-latest
    permissions:
      contents: write # Essential for the bot to push changes back
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.x'

      - name: Install Dependencies
        run: pip install beautifulsoup4

      - name: Execute Logic Automation
        run: |
          python3 - <<EOF
          import os
          import random
          from datetime import datetime
          from bs4 import BeautifulSoup

          # --- Zero Maintenance Configurations ---
          BRAND_BLUE = "hsl(240, 80%, 50%)"
          BASE_TITLE = "Hassan Biswas â€” UI/UX & Front-End Architecture"
          VERSION_ID = datetime.now().day 
          
          CORE_TECH = ["Agentic UX", "Generative UI", "Core Web Vitals", "Edge-Native Apps", "Spatial Web Design"]
          DESIGN_STYLES = ["Neubrutalism", "Minimalist Logic", "Tactile UI", "Awwwards Aesthetics"]
          SEO_FOCUS = ["Zero-Click Optimization", "Semantic HTML", "Performance-First", "SEO Architecture"]

          def get_forever_trends():
              now = datetime.now()
              seed = now.year + now.month
              random.seed(seed) 
              return f"{random.choice(CORE_TECH)}, {random.choice(DESIGN_STYLES)}, {random.choice(SEO_FOCUS)}"

          def update_html_seo(file_path):
              file_name = os.path.basename(file_path).replace(".html", "")
              page_subject = "Home" if file_name.lower() == "index" else file_name.replace("-", " ").title()
              trends = get_forever_trends()
              current_month_year = datetime.now().strftime("%B %Y")

              with open(file_path, 'r', encoding='utf-8') as f:
                  soup = BeautifulSoup(f, 'html.parser')

              if not soup.head: return
              
              # SEO Context Mapping
              seo_data = {
                  "title": f"{page_subject} | {BASE_TITLE}",
                  "description": f"Expert {page_subject} by Hassan Biswas. Featuring {trends}. Optimized for {current_month_year}. Ver: {VERSION_ID}",
                  "keywords": f"Hassan Biswas, {page_subject}, {trends}, Web Developer, UI/UX",
                  "theme-color": BRAND_BLUE,
                  "author": "Hassan Biswas"
              }

              # Update Title
              if soup.title: soup.title.string = seo_data["title"]
              
              # Update Meta Tags
              for name, content in seo_data.items():
                  if name == "title": continue
                  tag = soup.find('meta', attrs={"name": name})
                  if tag: tag['content'] = content
                  else: 
                      new_meta = soup.new_tag('meta', attrs={"name": name, "content": content})
                      soup.head.append(new_meta)

              with open(file_path, 'w', encoding='utf-8') as f:
                  f.write(soup.prettify())

          for root, _, files in os.walk("."):
              for file in files:
                  if file.endswith(".html") and "_site" not in root:
                      update_html_seo(os.path.join(root, file))
          EOF

      - name: Commit and Push changes
        run: |
          git config --global user.name 'Hassan Biswas'
          git config --global user.email 'hassanbiswas.github.io@gmail.com'
          git add .
          # Using logic automation for the commit message
          git commit -m "ðŸš€ SEO Update: $(date +'%B %Y') [Ver: $(date +'%d')]" || exit 0
          git push
          
