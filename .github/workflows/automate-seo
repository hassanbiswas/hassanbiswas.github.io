name: Automate SEO Submission

on:
  push:
    branches: [ main ]
  schedule:
    - cron: '0 0 * * *' # Runs daily at midnight for zero-maintenance freshness
  workflow_dispatch: # Allows manual trigger if needed

jobs:
  seo-submission:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Submit to IndexNow (Bing/Yandex)
        run: |
          # Automates URL submission without API keys that expire
          # Uses your GitHub Pages URL from your profile
          curl -X POST "https://api.indexnow.org/indexnow" \
          -H "Content-Type: application/json; charset=utf-8" \
          -d '{
            "host": "hassanbiswas.github.io",
            "key": "${{ secrets.INDEXNOW_KEY }}",
            "keyLocation": "https://hassanbiswas.github.io/${{ secrets.INDEXNOW_KEY }}.txt",
            "urlList": [
              "https://hassanbiswas.github.io/",
              "https://hassanbiswas.github.io/index.html"
            ]
          }'

      - name: Notify Google via Sitemap (Modern Method)
        run: |
          # Since the /ping endpoint is deprecated, we ensure Google 
          # sees the 'lastmod' change by hitting the sitemap directly
          curl -I "https://hassanbiswas.github.io/sitemap.xml"
